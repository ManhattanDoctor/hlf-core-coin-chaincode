## Назначение проекта

**hlf-core-coin-chaincode** — это модуль для управления токенами (монетами) и их счетами в блокчейн-среде, построенной на Hyperledger Fabric.  
Проект реализует логику создания, хранения, перевода, удержания (hold), сжигания (burn) и учёта баланса токенов, а также обработку событий, связанных с этими операциями.

---

## Основные сущности и архитектура

### 1. **Монета (Coin)**
- Представляет собой цифровой актив с уникальным идентификатором, владельцем и балансом.
- Операции: создание, эмиссия (emit), сжигание (burn), перевод (transfer), удержание (hold/unhold).

### 2. **Счёт монеты (CoinAccount)**
- Привязан к объекту (например, пользователю или организации).
- Хранит информацию о балансе, удержанных и доступных средствах.

### 3. **Менеджеры**
- **CoinManager** — основной класс для управления монетами и их счетами. Реализует интерфейс ICoinManager, наследует EntityManagerImpl.
  - Операции: создание монеты, получение/сохранение, эмиссия, сжигание, перевод, удержание, снятие удержания, удаление монеты и связанных счетов.
  - Взаимодействует с CoinAccountManager для работы со счетами.
- **CoinAccountManager** — управляет счетами монет, реализует сохранение, удаление и преобразование данных.

### 4. **Сервисный слой**
- **CoinService** — фасад для бизнес-логики, инкапсулирует работу с CoinManager и CoinAccountManager.
  - Проверяет входные параметры, выбрасывает кастомные ошибки, диспатчит события (emit, burn, transfer и др.).
  - Предназначен для использования в смарт-контрактах или других сервисах, взаимодействующих с блокчейном.

### 5. **Ошибки**
- Кастомные классы ошибок (CoinNotFoundError, CoinObjectNotFoundError, CoinFromToEqualsError) с кодами ошибок и статусами.
- Используется наследование от ExtendedError для унификации обработки ошибок.

### 6. **Интерфейсы и DTO**
- ICoinManager — определяет контракт для менеджера монет.
- ICoinMovement, ICoinTransfer — структуры для возврата результатов операций.
- DTO для входных параметров (ICoinEmitDto, ICoinTransferDto и др.) импортируются из внешнего пакета.

---

## Основные функции и сценарии использования

1. **Создание монеты**  
   - Через CoinManager, с указанием идентификатора, владельца и количества знаков после запятой.

2. **Эмиссия (emit/emitHeld)**  
   - Увеличение баланса монеты и счёта, либо перевод средств в удержание.

3. **Сжигание (burn/burnHeld)**  
   - Уменьшение баланса монеты и счёта, либо сжигание удержанных средств.

4. **Удержание и снятие удержания (hold/unhold)**  
   - Перевод средств в удержание и обратно.

5. **Переводы (transfer, transferToHeld, transferFromHeld, transferFromToHeld)**  
   - Перевод между счетами, перевод в удержание, перевод из удержания, комбинированные операции.

6. **Получение баланса**  
   - Получение информации о доступных, удержанных и общих средствах на счёте.

7. **Удаление монеты и связанных счетов**  
   - Полное удаление монеты и всех её счетов из системы.

---

## Взаимодействие с внешними системами

- **IStub/IStubHolder** — абстракция для доступа к состоянию блокчейна (чтение/запись данных, диспатчинг событий).
- **События** — при изменении состояния (эмиссия, перевод, удержание и т.д.) диспатчатся соответствующие события для интеграции с внешними системами или триггеров.

---

## Ключевые особенности

- **Модульность и расширяемость** — архитектура построена на интерфейсах и менеджерах, что позволяет легко расширять и модифицировать логику.
- **Строгая типизация** — используется TypeScript, что повышает надёжность и читаемость кода.
- **Обработка ошибок** — реализованы кастомные ошибки с кодами и статусами для удобства интеграции и отладки.
- **Событийная модель** — поддержка событий для отслеживания изменений состояния.

---

## Возможные сценарии применения

- Смарт-контракты для токенизации активов в Hyperledger Fabric.
- Внутренние платёжные системы, loyalty-программы, учётные системы с цифровыми активами.
- Любые системы, где требуется учёт, перевод, удержание и сжигание цифровых средств с прозрачной историей операций.

---